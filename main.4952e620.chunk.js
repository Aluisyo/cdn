(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{138:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(29),s=a.n(l),o=(a(53),a(2)),i=a.n(o),c=a(5),u=a(17),d=a(18),p=a(20),m=a(19),f=a(21),x=(a(55),a(56),a(11)),g=function(){var e=Object(c.a)(i.a.mark(function e(t){var a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=function(e){return new Promise(function(t,a){var n=new FileReader;n.onerror=function(){n.abort(),a()},n.addEventListener("load",function(){t(n.result)},!1),n.readAsText(e)})},e.abrupt("return",a(t));case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),b=a(45),h=a.n(b).a.init({host:"arweave.net",port:443,protocol:"https",timeout:2e4,logging:!1}),v=function(){var e=Object(c.a)(i.a.mark(function e(){var t,a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={op:"equals",expr1:"App-Name",expr2:"atheneum"},e.next=4,h.arql(t);case 4:return a=e.sent,e.abrupt("return",a);case 8:return e.prev=8,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",[]);case 12:case"end":return e.stop()}},e,null,[[0,8]])}));return function(){return e.apply(this,arguments)}}(),w=function(){var e=Object(c.a)(i.a.mark(function e(t){var a,n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a={op:"and",expr1:{op:"equals",expr1:"from",expr2:t},expr2:{op:"equals",expr1:"App-Name",expr2:"atheneum"}},e.next=4,h.arql(a);case 4:return n=e.sent,e.abrupt("return",n);case 8:return e.prev=8,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",[]);case 12:case"end":return e.stop()}},e,null,[[0,8]])}));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=Object(c.a)(i.a.mark(function e(t){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(c.a)(i.a.mark(function e(a,n){var r,l,s;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h.transactions.get(t);case 3:return r=e.sent,l=JSON.parse(r.get("data",{decode:!0,string:!0})),e.next=7,h.wallets.ownerToAddress(r.owner);case 7:s=e.sent,a({txId:t,from:s,txData:l}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),a({error:!0,err:e.t0});case 14:case"end":return e.stop()}},e,null,[[0,11]])}));return function(t,a){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),E=function(){var e=Object(c.a)(i.a.mark(function e(t){var a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=function(e){return new Promise(function(t,a){var n=new FileReader;n.onerror=function(){n.abort(),a()},n.addEventListener("load",function(){t(n.result)},!1),n.readAsDataURL(e)})},e.abrupt("return",a(t));case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),k=a(47),P=a.n(k),L=a(15),O=a.n(L),S=a(46),B=a.n(S),j=function(e){var t=e.data,a=t.from,n=t.txData;return r.a.createElement("div",{style:{marginLeft:"auto",marginRight:"auto",backgroundColor:"#dfe6e9",marginTop:10,marginBottom:10,padding:10},class:"bx--form-item"},r.a.createElement("p",{style:{padding:10}},n.text),n.file.includes("data:application")&&r.a.createElement("div",{style:{marginLeft:"auto",marginRight:"auto"},class:"bx--text-area__wrapper"},r.a.createElement("embed",{align:"center",src:n.file,id:"text-area-3",style:{maxWidth:350,maxHeight:300},alt:"Loaded"})),r.a.createElement("a",{href:n.file,download:!0}," Download "),r.a.createElement("p",{align:"center",style:{padding:5,fontSize:10}},"Uploaded By:",a))},A=function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(p.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={listData:[],userAddress:"",load:!1},a.getPostByAddress=Object(c.a)(i.a.mark(function e(){var t,n,r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,w(a.state.userAddress);case 3:return t=e.sent,n=[],t.map(function(e){return n.push(y(e))}),e.next=8,Promise.all(n);case 8:if(0!==(r=e.sent).length){e.next=14;break}return alert("Not Found"),e.abrupt("return");case 14:a.setState({listData:r});case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(0),alert("Error");case 20:case"end":return e.stop()}},e,null,[[0,17]])})),a}return Object(f.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{style:{marginLeft:"auto",marginRight:"auto"},class:"bx--form-item bx--text-input-wrapper"},r.a.createElement("label",{for:"text-input-3",class:"bx--label"},"Arweave Address"),r.a.createElement("div",{class:"bx--text-input__field-wrapper"},r.a.createElement("input",{onChange:function(t){return e.setState({userAddress:t.target.value})},id:"text-input-3",type:"text",class:"bx--text-input"})),r.a.createElement("button",{onClick:this.getPostByAddress,class:"bx--btn bx--btn--primary",type:"button"},"Search"),this.state.listData.map(function(e){return r.a.createElement(j,{data:e})}))}}]),t}(r.a.Component),T=function(e){var t=e.data,a=t.from,n=t.txData;return r.a.createElement("div",{style:{marginLeft:"auto",marginRight:"auto",backgroundColor:"#dfe6e9",marginTop:10,marginBottom:10,padding:10},class:"bx--form-item"},r.a.createElement("p",{style:{padding:10}},n.text),n.file.includes("data:application")&&r.a.createElement("div",{style:{marginLeft:"auto",marginRight:"auto"},class:"bx--text-area__wrapper"},r.a.createElement("embed",{align:"center",src:n.file,id:"text-area-3",style:{Width:350,Height:500},alt:"Loaded"})),r.a.createElement("a",{href:n.file,download:!0}," Download "),r.a.createElement("p",{align:"center",style:{padding:5,fontSize:10}},"Uploaded By:",a))},C=function(e){return 0===e.data.length?r.a.createElement("div",{style:{marginLeft:"auto",marginRight:"auto",backgroundColor:"#dfe6e9",marginTop:10,marginBottom:10,padding:10},class:"bx--form-item"},r.a.createElement("p",{style:{padding:10}},"Nothing to show")):e.data.map(function(e){return r.a.createElement(T,{data:e})})},D=function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(p.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={loading:!1,loadWallet:!1,walletAddress:"",walletBalance:"",walletData:!1,textPost:"",filePost:"",txModalOpen:!1,transaction:"",fee:"",loadingTx:!1,publicPosts:[],userPost:[],tab:0},a.clickLoadWallet=function(){document.getElementById("wallet-handler").click()},a.loadWallet=function(){var e=Object(c.a)(i.a.mark(function e(t){var n,r,l,s,o,c;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a.setState({loading:!0}),e.next=4,g(t.target.files[0]);case 4:return n=e.sent,r=JSON.parse(n),e.next=8,h.wallets.jwkToAddress(r);case 8:return l=e.sent,e.next=11,h.wallets.getBalance(l);case 11:return s=e.sent,e.next=14,h.ar.winstonToAr(s);case 14:return o=e.sent,e.next=17,a.getPostByAddress(l);case 17:c=e.sent,a.setState({walletData:r,userPost:c,walletAddress:l,walletBalance:o,loading:!1,loadWallet:!0}),e.next=26;break;case 21:e.prev=21,e.t0=e.catch(0),console.log(e.t0),a.setState({loading:!1}),alert("Error Loading Wallet");case 26:case"end":return e.stop()}},e,null,[[0,21]])}));return function(t){return e.apply(this,arguments)}}(),a.clickLoadfile=function(){document.getElementById("file-handler").click()},a.loadfile=function(){var e=Object(c.a)(i.a.mark(function e(t){var n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a.setState({loading:!0,fileLoaded:!1,filePost:""}),e.next=4,E(t.target.files[0]);case 4:n=e.sent,console.log(n),n.includes("data:application/pdf")?a.setState({loading:!1,filePost:n,fileLoaded:!0}):(a.setState({loading:!1,fileLoaded:!1,filePost:""}),alert("Please upload only pdf files")),e.next=14;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0),a.setState({loading:!1,fileLoaded:!1,filePost:""}),alert("Error Loading File");case 14:case"end":return e.stop()}},e,null,[[0,9]])}));return function(t){return e.apply(this,arguments)}}(),a.newPost=Object(c.a)(i.a.mark(function e(){var t,n,r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,a.state.loadWallet){e.next=4;break}return alert("Load your Arweave Wallet to Log in"),e.abrupt("return");case 4:return a.setState({loading:!0}),t=JSON.stringify({text:a.state.textPost,file:a.state.filePost}),e.next=8,h.createTransaction({data:t},a.state.walletData);case 8:return(n=e.sent).addTag("App-Name","atheneum"),n.addTag("atheneum","post"),e.next=13,h.ar.winstonToAr(n.reward);case 13:r=e.sent,a.setState({transaction:n,fee:r,loading:!1,txModalOpen:!0}),e.next=22;break;case 17:return e.prev=17,e.t0=e.catch(0),console.log(e.t0),a.setState({loading:!1,txModalOpen:!1}),e.abrupt("return");case 22:case"end":return e.stop()}},e,null,[[0,17]])})),a.getPosts=Object(c.a)(i.a.mark(function e(){var t,a,n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v();case 3:return t=e.sent,a=[],t.map(function(e){return a.push(y(e))}),e.next=8,Promise.all(a);case 8:return n=e.sent,e.abrupt("return",n);case 12:return e.prev=12,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",[]);case 16:case"end":return e.stop()}},e,null,[[0,12]])})),a.getPostByAddress=function(){var e=Object(c.a)(i.a.mark(function e(t){var a,n,r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,w(t);case 3:return a=e.sent,n=[],a.map(function(e){return n.push(y(e))}),e.next=8,Promise.all(n);case 8:return r=e.sent,e.abrupt("return",r);case 12:return e.prev=12,e.t0=e.catch(0),e.abrupt("return",[]);case 15:case"end":return e.stop()}},e,null,[[0,12]])}));return function(t){return e.apply(this,arguments)}}(),a.confirmNewPost=Object(c.a)(i.a.mark(function e(){var t,n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h.wallets.getBalance(a.state.walletAddress);case 3:if(t=e.sent,!(parseInt(a.state.transaction.reward)>parseInt(t))){e.next=7;break}return alert("Insuficient Balance"),e.abrupt("return");case 7:return a.setState({loadingTx:!0}),n=a.state.transaction,e.next=11,h.transactions.sign(n,a.state.walletData);case 11:return e.next=13,h.transactions.post(n);case 13:a.setState({loadingTx:!1,txModalOpen:!1,textPost:"",transaction:"",fee:"",filePost:""}),alert("Book uploaded successfuly, Please wait for it to be mined on a block for it to appear in the Library"),e.next=21;break;case 17:e.prev=17,e.t0=e.catch(0),alert("Error"),a.setState({loadingTx:!1});case 21:case"end":return e.stop()}},e,null,[[0,17]])})),a.closeTxModal=function(){return a.setState({txModalOpen:!1})},a}return Object(f.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=Object(c.a)(i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.getPosts();case 3:t=e.sent,this.setState({publicPosts:t}),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}},e,this,[[0,7]])}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,r.a.createElement(x.Header,null,r.a.createElement(x.HeaderName,{href:"#",prefix:"Atheneum"}),r.a.createElement(x.HeaderNavigation,null,r.a.createElement(x.HeaderMenuItem,{href:"https://tokens.arweave.org/"},"Get some free tokens"),r.a.createElement(x.HeaderGlobalBar,null,this.state.loadWallet?null:r.a.createElement(x.HeaderMenuItem,{onClick:function(){return e.clickLoadWallet()}},"Load Wallet to log in",r.a.createElement("input",{type:"file",onChange:function(t){return e.loadWallet(t)},id:"wallet-handler",style:{display:"none"}})))))),r.a.createElement("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-between",paddingTop:70}},r.a.createElement("div",{style:{marginLeft:"auto",marginRight:"auto"},class:"bx--form-item"}),r.a.createElement("h1",{align:"center"}," Welcome to Atheneum - The Open, Decentralized and Permanent Library"),r.a.createElement("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-between",paddingTop:70}},r.a.createElement("div",{style:{marginLeft:"auto",marginRight:"auto"},class:"bx--form-item"}),r.a.createElement("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-between"}},r.a.createElement(B.a,{selected:this.state.tab},r.a.createElement(O.a,{label:"Library",onClick:function(){return e.setState({tab:0})}}),r.a.createElement(O.a,{label:"My Book(s)",onClick:function(){return e.setState({tab:1})}}),r.a.createElement(O.a,{label:"Upload Book",onClick:function(){return e.setState({tab:2})}},this.state.walletData&&r.a.createElement(r.a.Fragment,null,r.a.createElement("p",{align:"center",style:{marginTop:50}},this.state.walletAddress),r.a.createElement("p",{align:"center"},this.state.walletBalance," AR")),r.a.createElement("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-between",paddingTop:70}},r.a.createElement("div",{style:{marginLeft:"auto",marginRight:"auto"},class:"bx--form-item"},r.a.createElement("label",{for:"text-area-2",class:"bx--label"},"Book Title"),r.a.createElement("div",{class:"bx--text-area__wrapper"},r.a.createElement("input",{value:this.state.textPost,onChange:function(t){return e.setState({textPost:t.target.value})},id:"text-area-2",class:"bx--text-area",rows:"4",cols:"50",placeholder:"Title"}))),this.state.filePost&&r.a.createElement("div",{style:{marginLeft:"auto",marginRight:"auto"},class:"bx--form-item"},r.a.createElement("label",{for:"text-area-3",class:"bx--label"},"Loaded Book"),r.a.createElement("div",{class:"bx--text-area__wrapper"},r.a.createElement("embed",{src:this.state.filePost,id:"text-area-3",style:{maxWidth:350,maxHeight:500},alt:"Loaded"}))),r.a.createElement("div",{style:{marginLeft:"auto",marginRight:"auto"},class:"bx--form-item"},r.a.createElement("button",{class:"bx--btn bx--btn--secondary",onClick:this.clickLoadfile,type:"button"},"Upload Book"),r.a.createElement("input",{type:"file",accept:"application/pdf",onChange:function(t){return e.loadfile(t)},id:"file-handler",style:{display:"none"}})),r.a.createElement("div",{style:{marginLeft:"auto",marginRight:"auto"},class:"bx--form-item"},r.a.createElement("button",{onClick:this.newPost,class:"bx--btn bx--btn--primary",type:"button"},"Submit Post")))),r.a.createElement(O.a,{label:"Search Book(s)",onClick:function(){return e.setState({tab:3})}})),0===this.state.tab&&r.a.createElement(C,{data:this.state.publicPosts}),1===this.state.tab&&r.a.createElement(C,{data:this.state.userPost}),2===this.state.tab,3===this.state.tab&&r.a.createElement(A,null)))),r.a.createElement(P.a,{open:this.state.txModalOpen,modalHeading:"New Upload",primaryButtonText:"Confirm",secondaryButtonText:"Cancel",onRequestSubmit:this.confirmNewPost,onSecondarySubmit:this.closeTxModal},r.a.createElement("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-between"}},r.a.createElement("div",{style:{marginLeft:"auto",marginRight:"auto"}},r.a.createElement("label",{for:"fee-confirm",class:"bx--label"},"Transaction Fee"),r.a.createElement("p",{id:"fee-confirm"},this.state.fee," AR"),r.a.createElement("label",{for:"txt-confirm",class:"bx--label"},"Title"),r.a.createElement("p",{id:"txt-confirm"},this.state.textPost),this.state.filePost&&r.a.createElement("div",{style:{marginLeft:"auto",marginRight:"auto"},class:"bx--form-item"},r.a.createElement("label",{for:"pdf-confirm",class:"bx--label"},"Loaded Book"),r.a.createElement("div",{class:"bx--text-area__wrapper"},r.a.createElement("embed",{src:this.state.filePost,id:"pdf-confirm",style:{maxWidth:350,maxHeight:350},alt:"Loaded"}))),this.state.loadingTx&&r.a.createElement("div",{class:"bx--loading-overlay"},r.a.createElement("div",{"data-loading":!0,class:"bx--loading"},r.a.createElement("svg",{class:"bx--loading__svg",viewBox:"-75 -75 150 150"},r.a.createElement("title",null,"Loading"),r.a.createElement("circle",{class:"bx--loading__stroke",cx:"0",cy:"0",r:"37.5"}))))))),this.state.loading&&r.a.createElement("div",{class:"bx--loading-overlay"},r.a.createElement("div",{"data-loading":!0,class:"bx--loading"},r.a.createElement("svg",{class:"bx--loading__svg",viewBox:"-75 -75 150 150"},r.a.createElement("title",null,"Loading"),r.a.createElement("circle",{class:"bx--loading__stroke",cx:"0",cy:"0",r:"37.5"})))))}}]),t}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(D,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},48:function(e,t,a){e.exports=a(138)},53:function(e,t,a){},55:function(e,t,a){}},[[48,1,2]]]);
//# sourceMappingURL=main.4952e620.chunk.js.map